environment:
  contents:
    packages:
      - build-base
      - busybox
      - ca-certificates-bundle
      - py3-setuptools
      - python-3
      - wolfi-base

package:
  copyright:
    - license: BSD-3-Clause
  dependencies:
    runtime:
      - py3-blinker
      - py3-click
      - py3-importlib-metadata
      - py3-itsdangerous
      - py3-jinja2
      - py3-werkzeug
      - python-3
  description: A simple framework for building complex web applications.
  epoch: 0
  name: py3-flask
  version: 3.0.3

pipeline:
  - uses: fetch
    with:
      expected-sha256: ceb27b0af3823ea2737928a4d99d125a06175b8512c445cbd9a9ce200ef76842
      uri: https://files.pythonhosted.org/packages/source/f/flask/flask-${{package.version}}.tar.gz

  - name: Python Build
    uses: python/build-wheel

  - uses: strip

test:
  environment:
    contents:
      packages:
        - curl
    environment:
      FLASK_APP: /tmp/flask_app.py
  pipeline:
    - name: Test Flask Installation and Server Running Capability
      runs: "cat <<EOF > /tmp/flask_app.py\nfrom flask import Flask\napp = Flask(__name__)\n\n@app.route('/')\ndef hello_world():\n    return 'Hello, World!'\nEOF\nexport FLASK_APP=/tmp/flask_app.py\nflask run &> /dev/null &\nflask_pid=$!\nsleep 2\ncurl -s \"http://127.0.0.1:5000/\" | grep -q \"Hello, World!\"\n"
    - uses: py/pip-check

update:
  enabled: true
  release-monitor:
    identifier: 3867
