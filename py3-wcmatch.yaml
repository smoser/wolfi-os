environment:
  contents:
    packages:
      - busybox
      - ca-certificates-bundle
      - py3-gpep517
      - py3-pip
      - py3-setuptools
      - py3-wheel
      - python3
      - wolfi-base

package:
  copyright:
    - license: MIT
  dependencies:
    runtime:
      - py3-bracex
      - python3
  description: Wilcard File Name matching library.
  epoch: 0
  name: py3-wcmatch
  version: '9.0'

pipeline:
  - uses: git-checkout
    with:
      expected-commit: 2939d2acb2a4cbdf911fe1320c611ddc09e0cd39
      repository: https://github.com/facelessuser/wcmatch
      tag: ${{package.version}}

  - runs: "# This is needed to work around the error \"ValueError: ZIP does not support timestamps before 1980\"\nexport SOURCE_DATE_EPOCH=315532800\npython3 -m pip install -U hatchling\npython3 -m gpep517 build-wheel \\\n  --wheel-dir dist \\\n  --output-fd 3 3>&1 >&2\npython3 -m installer \\\n  -d \"${{targets.destdir}}\" \\\n  dist/wcmatch-${{package.version}}-*.whl\ninstall -Dm644 LICENSE.md \\\n  \"${{targets.destdir}}\"/usr/share/licenses/${{package.name}}/LICENSE\n"

  - uses: strip

test:
  environment:
    contents:
      packages:
        - py3-pip
  pipeline:
    - runs: '# Test import of wcmatch

        python3 -c ''import wcmatch; print("wcmatch imported successfully")''

      '
    - runs: '# Create test files

        touch test_file.txt

        touch another_test_file.txt

      '
    - runs: '# Test basic file matching with wcmatch

        python3 -c ''

        import wcmatch

        from wcmatch import glob

        # Test glob functionality

        matched_files = glob.glob("test_file.txt")

        print("Matched files:", matched_files)

        assert "test_file.txt" in matched_files

        print("wcmatch glob test passed")

        ''

      '
    - runs: '# Test multiple file matching with wcmatch

        python3 -c ''

        import wcmatch

        from wcmatch import glob

        # Test glob functionality with multiple files

        matched_files = glob.glob("*.txt")

        print("Matched .txt files:", matched_files)

        assert "test_file.txt" in matched_files

        assert "another_test_file.txt" in matched_files

        print("wcmatch multiple file glob test passed")

        ''

      '
    - uses: py/pip-check

update:
  enabled: true
  github:
    identifier: facelessuser/wcmatch
