# Generated from https://git.alpinelinux.org/aports/plain/main/docbook-xsl/APKBUILD
package:
  name: docbook-xsl
  version: 1.79.2
  epoch: 0
  description: XML stylesheets for Docbook-xml transformations.
  copyright:
    - license: custom

environment:
  contents:
    packages:
      - autoconf
      - automake
      - build-base
      - busybox
      - ca-certificates-bundle
      - docbook-xml
      - libxml2-utils
      - libxslt

pipeline:
  - uses: fetch
    with:
      expected-sha256: 966188d7c05fc76eaca115a55893e643dd01a3486f6368733c9ad974fcee7a26
      uri: https://github.com/docbook/xslt10-stylesheets/releases/download/release%2F${{package.version}}/docbook-xsl-${{package.version}}.tar.gz

  - runs: |
      pkgdir=${{targets.contextdir}}
      pkgver=${{package.version}}
      _dest="$pkgdir"/usr/share/xml/docbook/xsl-stylesheets-$pkgver

      install -dm755 "$_dest"
      install -m644 VERSION VERSION.xsl "$_dest"/
      ln -s xsl-stylesheets-$pkgver "${_dest%/*}/xsl-stylesheets"

      for dir in assembly common eclipse epub epub3 fo highlighting html \
          htmlhelp javahelp lib manpages params profiling roundtrip \
          template website xhtml xhtml-1_1 xhtml5; do

          install -dm755 $_dest/$dir
          for f in $dir/*.xml $dir/*.xsl $dir/*.dtd $dir/*.ent; do
              [ -e "$f" ] || continue
              install -m644 $f $_dest/$dir
          done
      done

      install -dm755 "$pkgdir"/etc/xml

      install -m644 -D COPYING \
        "$pkgdir"/usr/share/licenses/$pkgname/COPYING
